<!-- Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

<!-- jQuery (đảm bảo sử dụng phiên bản đầy đủ, không phải slim) -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<!-- Popper.js (tối cần thiết cho Bootstrap) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


<!-- Start Content -->
<div class="container py-5">
  <div class="row">
    <!--Sider bar-->
    <div class="col-lg-3">
      <h1 class="h2 pb-4">Categories</h1>
      <ul class="list-unstyled templatemo-accordion">
        <!-- Bộ lọc Thương hiệu -->
        <li class="pb-3">
          <a class="collapsed d-flex justify-content-between h3 text-decoration-none"
            (click)="toggleCollapse('categoryPhone')">
            Category Phone
            <i class="fa fa-fw"
              [ngClass]="{'fa-chevron-circle-down': isCollapsed['categoryPhone'], 'fa-chevron-circle-up': !isCollapsed['categoryPhone']}"></i>
          </a>
          <ul *ngIf="!isCollapsed['categoryPhone']" class="list-unstyled pl-3">
            <!-- Thêm tùy chọn "Tất cả sản phẩm" -->
            <li>
              <a class="text-decoration-none" style="font-size: 22px;" href="">
                All Products
              </a>
            </li>
            <!-- Lặp qua các thương hiệu duy nhất -->
            <li *ngFor="let brand of filteredBrands$ | async">
              <a style="font-size: 20px;" class="text-decoration-none" href="javascript:void(0)"
                (click)="selectBrand(brand.brandName)" [ngClass]="{'text-danger': selectedBrand === brand.brandName}">
                {{ brand.brandName }}
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </div>

    <!--End Sidebar-->

    <div class="col-lg-9">

      <div class="row">
        <h1>All Products</h1>
      </div>

      <!-- Hiển thị sản phẩm (sử dụng *ngFor để lặp qua danh sách sản phẩm) -->
      <div class="row">
        <div class="col-md-4" *ngFor="let product of filteredProducts">
          <div class="card mb-4 product-wap rounded-0">
            <div class="card rounded-0">
              <img class="card-img rounded-0 img-fluid" [src]="product.imageUrl" alt="Product Image">
            </div>
            <div class="card-body">
              <!-- Liên kết tới trang chi tiết sản phẩm dựa trên ProductId hoặc trang shop dựa trên BrandId -->
              <a [routerLink]="['/shop', product.brandId]" class="h3 text-decoration-none">{{ product.productName }}</a>

              <!-- Hiển thị các màu sắc của sản phẩm -->
              <ul class="w-100 list-unstyled d-flex justify-content-between mb-0">
                <li>
                  <span *ngFor="let color of product.color.split(',')" class="product-color-dot"
                    [ngClass]="'color-dot-' + color"></span>
                </li>
              </ul>

              <!-- Hiển thị đánh giá sản phẩm (giả định hiển thị 3 sao vàng và 2 sao xám) -->
              <ul class="list-unstyled d-flex justify-content-center mb-1">
                <li>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-muted fa fa-star-half-o"></i>
                </li>
              </ul>

              <!-- Hiển thị giá bán của sản phẩm -->
              <p class="text-center mb-0">{{ product.sellPrice | currency }}</p>

              <!-- Các hành động của người dùng (Yêu thích, Xem chi tiết, Thêm vào giỏ hàng) -->
              <ul class="list-unstyled d-flex justify-content-center mb-0 product-actions">
                <li><a class="btn btn-success text-white" href="#"><i class="far fa-heart"></i></a></li>
                <li><a class="btn btn-success text-white" [routerLink]="['/product', product.productId]"><i
                      class="far fa-eye"></i></a></li>
                <li><a class="btn btn-success text-white" href="#"><i class="fas fa-cart-plus"></i></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>


      <!--Phan trang-->
      <div class="pagination">
        <button (click)="prevPage()" [disabled]="currentPage === 1" class="page-btn">
          <i class="fas fa-chevron-left"></i>
        </button>

        <!-- Danh sách các số trang -->
        <span *ngFor="let page of pages" (click)="goToPage(page)" [class.active]="page === currentPage"
          class="page-number">
          {{ page }}
        </span>

        <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="page-btn">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>
<!-- End Content -->

<!-- Add Bootstrap JS and jQuery before closing body tag -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> <!-- Đảm bảo dùng jQuery đầy đủ -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>